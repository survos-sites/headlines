{% extends 'base.html.twig' %}

{% block title %}Hello MomaController!{% endblock %}

{% block body %}

    <div class="example-wrapper">

        <h1>{{ kv.filename }}</h1>

        {#    {{ dump(charts) }} #}
        {% for tableName, indexes in charts %}
            <h2>{{ tableName }}</h2>
                {% for indexName, chart in indexes %}
                    <div class="row">
                    <div class="col-md-3">
                        <h3>{{ indexName }}</h3>
                        <div class="my-chart">
                            {{ render_chart(chart) }}
                        </div>
                    </div>
                    <div class="col-md-3">
                        <table class="table table-responsive-sm">
                            <tbody>
                            {% for c in  kv.getCounts(indexName, tableName) %}
                                <tr>
                                    <td>{{ c.value }}</td>
                                    <td>{{ c.count }}</td>
                                </tr>
                            {% endfor %}
{#                            {{ kv.getCounts(indexName, tableName)|map(c => "#{c.value} #{c.count}")|join("<br />")|raw }}#}

                            </tbody>
                        </table>
                    </div>
                    </div>
                {% endfor %}
        {% endfor %}


        {#    {% endfor %} #}

        Using KV, no doctrine!
        {% for table in kv.tables %}
            {#        {{ dump(table) }} #}
            <h3>
                {{ table }}
            </h3>
            {% for index in kv.indexes(table) %}
                <b>{{ index }}</b>
                {{ kv.getCounts(index, table)|map(c => "#{c.value} #{c.count}")|join("<br />")|raw }}
            {% endfor %}

            {% for row in kv.iterate(table) %}
                {% if loop.index < 3 %}
{#                    {{ dump(row) }}#}
                {% endif %}
            {% endfor %}
        {% endfor %}
    </div>
{% endblock %}
